<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draft Invoices</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            padding: 20px;
            max-width: 800px;
            margin: auto;
        }
        h1 {
            color: #333;
        }
        #filter-section, #search-bar {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        #invoice-list {
            list-style: none;
            padding: 0;
        }
        .invoice-item {
            padding: 10px;
            margin: 10px 0;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .invoice-info {
            display: flex;
            flex-direction: column;
            text-align: left;
        }
        .invoice-link {
            font-weight: bold;
            color: #0066cc;
            text-decoration: none;
        }
        .status-paid { color: green; }
        .status-unpaid { color: red; }
        .status-overdue { color: orange; }
    </style>
</head>
<body>
    <h1>Draft Invoices Page</h1>

    <!-- Tìm kiếm và lọc -->
    <div id="search-bar">
        <input type="text" placeholder="Search invoices by ID or customer name..." id="search-input">
    </div>
    <div id="filter-section">
        <label>
            Sort by:
            <select id="sort-select">
                <option value="date">Date</option>
                <option value="amount">Amount</option>
            </select>
        </label>
        <label>
            Status:
            <select id="status-filter">
                <option value="all">All</option>
                <option value="paid">Paid</option>
                <option value="unpaid">Unpaid</option>
                <option value="overdue">Overdue</option>
            </select>
        </label>
    </div>

    <ul id="invoice-list"></ul>

    <script>
        fetch('invoices.json')
            .then(response => response.json())
            .then(data => {
                const invoiceList = document.getElementById('invoice-list');
                const searchInput = document.getElementById('search-input');
                const sortSelect = document.getElementById('sort-select');
                const statusFilter = document.getElementById('status-filter');

                // Hàm hiển thị hóa đơn
                function displayInvoices(invoices) {
                    invoiceList.innerHTML = '';
                    invoices.forEach(invoice => {
                        const listItem = document.createElement('li');
                        listItem.classList.add('invoice-item');
                        listItem.innerHTML = `
                            <div class="invoice-info">
                                <a href="view.html?invoice_id=${invoice.id}" class="invoice-link">Invoice ${invoice.id}</a>
                                <span>${invoice.date} - ${invoice.customer}</span>
                                <span class="${getStatusClass(invoice.status)}">${invoice.status}</span>
                            </div>
                            <div>$${invoice.amount}</div>
                        `;
                        invoiceList.appendChild(listItem);
                    });
                }

                // Hàm lấy class trạng thái
                function getStatusClass(status) {
                    return status === 'Paid' ? 'status-paid' :
                           status === 'Unpaid' ? 'status-unpaid' : 'status-overdue';
                }

                // Hiển thị ban đầu và bộ lọc
                displayInvoices(data.invoices);

                searchInput.addEventListener('input', () => {
                    const searchTerm = searchInput.value.toLowerCase();
                    const filteredInvoices = data.invoices.filter(invoice =>
                        invoice.id.toLowerCase().includes(searchTerm) ||
                        invoice.customer.toLowerCase().includes(searchTerm)
                    );
                    displayInvoices(filteredInvoices);
                });

                sortSelect.addEventListener('change', () => {
                    const sortedInvoices = [...data.invoices].sort((a, b) =>
                        sortSelect.value === 'date' ? new Date(b.date) - new Date(a.date) :
                        b.amount - a.amount
                    );
                    displayInvoices(sortedInvoices);
                });

                statusFilter.addEventListener('change', () => {
                    const filteredInvoices = data.invoices.filter(invoice =>
                        statusFilter.value === 'all' || invoice.status.toLowerCase() === statusFilter.value
                    );
                    displayInvoices(filteredInvoices);
                });
            })
            .catch(error => console.error('Error loading invoices:', error));
    </script>
</body>
</html>
